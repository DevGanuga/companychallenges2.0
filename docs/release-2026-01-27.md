# Release Notes - January 27, 2026

## Overview

This release focuses on Sprint Container Architecture improvements, Password UX enhancements, Admin workflow refinements, and critical bug fixes based on user feedback.

---

## üéØ Key Features

### Sprint Container Architecture

Sprints are now fully functional as a middle layer between Challenges and Assignments:

- **Sprint Form** - Complete creation/editing with:
  - Sprint Name (required) and Subtitle
  - Cover Image upload
  - Rich Text Description (with full formatting toolbar)
  - Simple Description (plain text)
  - Password Protection (optional)
  - Intro and Recap Video URLs
  - Start/End Date scheduling
  
- **Sprint Management**
  - Create Sprint button in Challenge management view
  - Drag-and-drop reordering of sprints
  - Edit and delete sprints with assignment reassignment
  - Sprint password protection (non-persistent by design)

### Password System Improvements

#### Public Password Gate (Simplified UI)
- Simplified title: "Password" only (no extra text)
- Clean input placeholder: "Password"
- Submit button shows unlock icon only (no text)
- No "contact administrator" message
- Password instructions displayed when configured at challenge level

#### Admin Password Configuration
- Password field shows visible text (not masked) - intentional for gamification
- Helper text: "Password is visible because it's for gamification, not security. Case-insensitive."
- Browser autofill disabled (`autocomplete="off"`, `data-1p-ignore`, `data-lpignore`)
- **New:** "Remember password for session" checkbox
  - When checked: Password remembered for 24 hours (default behavior)
  - When unchecked: Password required on every visit

### Custom URL Support

Both Challenges and Assignments now support custom URLs:

- **Custom URL field** in Challenge and Assignment forms
- Case-sensitive URL support (important for legacy URL compatibility)
- Hint: "Leave empty for auto-generated URL. Case-sensitive."
- URL preview shown in edit dialogs

### Admin Workflow Improvements

#### Challenge Management
- **Copy URL buttons** for challenges in the list view
- **Copy link buttons** for each assignment within a challenge
- **Edit Challenge button** in challenge header
- Required fields marked with `*`:
  - Internal Name
  - Public Title  
  - Challenge Description

#### Assignment Library
- **Archive functionality** - Archive assignments instead of immediate deletion
- **Restore from archive** - Bring back archived assignments
- **Delete** - Only available for archived assignments (safety measure)
- Copy URL button for each assignment

---

## üêõ Bug Fixes

### Critical Fixes

| Issue | Resolution |
|-------|------------|
| Sprint Form dialog not opening | Fixed `DialogContent` nesting issue in `sprint-form.tsx` |
| Password saving failures | Added fallback hash function when RPC unavailable |
| Dialog delete button missing | Fixed nested `DialogContent` wrapper in delete confirmations |

### UI/UX Fixes

| Issue | Resolution |
|-------|------------|
| Password field showing bullets | Changed to `type="text"` for gamification visibility |
| Browser offering to save passwords | Added autocomplete/1password/lastpass ignore attributes |
| Font size dropdown not reflecting current state | Made controlled component |
| Color picker positioning | Added `z-index` and `overflow-visible` fixes |

---

## üìÅ Files Changed

### Components

```
components/admin/sprint-form.tsx        - Fixed DialogContent nesting
components/admin/assignment-form.tsx    - Password visibility, Custom URL, Remember toggle
components/admin/challenge-form.tsx     - Required fields, Custom URL
components/admin/assignment-list.tsx    - Copy URL, Archive/Restore/Delete
components/admin/sprint-list.tsx        - Drag-and-drop, Edit/Delete
components/public/password-gate.tsx     - Simplified UI
components/ui/simple-dialog.tsx         - Dialog wrapper fix
```

### Actions

```
lib/actions/assignments.ts    - Archive/restore functions, password hash fallback
lib/actions/sprints.ts        - Full CRUD operations with password support
lib/actions/public.ts         - Password remember logic, public sprint fetching
lib/actions/upload.ts         - Extended video MIME types (MOV, OGG)
```

### Database Migrations

```sql
-- 007_assignment_password_remember.sql
ALTER TABLE assignments ADD COLUMN password_remember BOOLEAN DEFAULT FALSE;

-- 008_assignment_archive.sql
ALTER TABLE assignments ADD COLUMN is_archived BOOLEAN DEFAULT FALSE;
ALTER TABLE assignments ADD COLUMN archived_at TIMESTAMPTZ;

-- 009_sprint_container.sql
ALTER TABLE sprints ADD COLUMN subtitle TEXT;
ALTER TABLE sprints ADD COLUMN description_html TEXT;
ALTER TABLE sprints ADD COLUMN cover_image_url TEXT;
ALTER TABLE sprints ADD COLUMN password_hash TEXT;
```

---

## üß™ Verified via Browser Testing

| Feature | Test Result |
|---------|-------------|
| Password Gate UI | ‚úÖ Simplified layout with unlock icon |
| Password Visibility (Admin) | ‚úÖ Plain text with helper message |
| Password Remember Toggle | ‚úÖ Checkbox working |
| Custom URL (Challenges) | ‚úÖ Case-sensitive field available |
| Custom URL (Assignments) | ‚úÖ Case-sensitive field available |
| Required Fields (Challenge) | ‚úÖ Marked with asterisk |
| Sprint Form Dialog | ‚úÖ Opens with all fields |
| Copy Link Buttons | ‚úÖ Available in challenge management |
| Assignment Cards | ‚úÖ Display correctly with lock icons |

---

## üì∏ Screenshots

Screenshots captured during testing are available at:
- `assignments-page-view.png` - Public assignment grid view
- `password-gate-simplified.png` - Simplified password entry
- `assignment-form-scrolled.png` - Admin password configuration
- `challenge-management-page.png` - Challenge admin view with sprints
- `sprint-form-working.png` - Sprint creation dialog

---

## üîú Pending Items (Next Release)

### Sprint Architecture
- [ ] Sprint overview mode on public `/c/[slug]/start` page
- [ ] Sprint password gate component
- [ ] Single-assignment sprint redirect optimization
- [ ] Back navigation from sprint to challenge

### Link Picker
- [ ] Client ‚Üí Challenge ‚Üí Assignment filtering
- [ ] Copy URL from assignment library view

### Form Enhancements
- [ ] Enable all quiz types
- [ ] Quiz editor only for `content_type='quiz'`
- [ ] "Save to library" checkbox when adding from library

### Other
- [ ] Permanent challenge deletion (beyond archive)
- [ ] Color picker positioning refinement in Firefox

---

## üöÄ Deployment Notes

1. Run database migrations in order:
   ```bash
   supabase db push
   ```

2. Verify environment variables are set:
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_ROLE_KEY`

3. Build and deploy:
   ```bash
   npm run build
   ```

---

## üìã Known Issues

- TipTap editor shows duplicate extension warning (cosmetic, no functional impact)
- Middleware deprecation warning in Next.js 16 (migration to proxy planned)

---

*Release prepared by AI Assistant on January 27, 2026*
